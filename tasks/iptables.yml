---

- name: Set OS family dependent variables
  include_vars: '{{ ansible_facts.os_family }}.yml'

- import_tasks: init.yml
  tags: init

- import_tasks: logging.yml
  tags: base_rules

- import_tasks: base_rules.yml
  tags: base_rules

- import_tasks: ipset.yml
  tags: ipset
  when: iptables_ban_hosts or iptables_block_bogons

- import_tasks: block_attacks.yml
  tags: block_attacks

- import_tasks: bogons.yml
  tags: bogons

- import_tasks: user_rules.yml
  tags: user_rules
